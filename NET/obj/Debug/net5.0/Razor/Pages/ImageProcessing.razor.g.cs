#pragma checksum "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor" "{8829d00f-11b8-4213-878b-770e8597ac16}" "4f575fb6b20d822b3c3376059fd29c92f1e1a4d43ca810033c37b12d3bbdfa90"
// <auto-generated/>
#pragma warning disable 1591
namespace NET.Pages
{
    #line hidden
    using global::System;
    using global::System.Collections.Generic;
    using global::Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using NET;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\CK2\source\repos\NET\NET\_Imports.razor"
using NET.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
using System.Threading.Tasks;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/image-processing")]
    public partial class ImageProcessing : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.AddMarkupContent(0, "<h3>Image Processing</h3>\r\n\r\n");
            __builder.OpenComponent<global::Microsoft.AspNetCore.Components.Forms.InputFile>(1);
            __builder.AddAttribute(2, "OnChange", (object)(global::Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<global::Microsoft.AspNetCore.Components.EventCallback<global::Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>>(global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Forms.InputFileChangeEventArgs>(this, 
#nullable restore
#line 10 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
                     HandleSelectedFiles

#line default
#line hidden
#nullable disable
            ))));
            __builder.AddAttribute(3, "multiple", (object)(true));
            __builder.CloseComponent();
            __builder.AddMarkupContent(4, "\r\n");
            __builder.OpenElement(5, "button");
            __builder.AddAttribute(6, "onclick", global::Microsoft.AspNetCore.Components.EventCallback.Factory.Create<global::Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 11 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
                  ProcessImages

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(7, "Process Images");
            __builder.CloseElement();
            __builder.AddMarkupContent(8, "\r\n\r\n");
            __builder.OpenElement(9, "ul");
#nullable restore
#line 14 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
     foreach (var path in processedImages)
    {

#line default
#line hidden
#nullable disable
            __builder.OpenElement(10, "li");
#nullable restore
#line 16 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
__builder.AddContent(11, path);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
#nullable restore
#line 17 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
    }

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
            __builder.AddMarkupContent(12, "\r\n\r\n");
            __builder.OpenElement(13, "p");
#nullable restore
#line 20 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
__builder.AddContent(14, statusMessage);

#line default
#line hidden
#nullable disable
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 22 "C:\Users\CK2\source\repos\NET\NET\Pages\ImageProcessing.razor"
       
    private IBrowserFile[] selectedFiles;
    private string statusMessage = string.Empty;
    private List<string> processedImages = new();
    private long maxFileSize = 1073741824; // 1G

    private void HandleSelectedFiles(InputFileChangeEventArgs e)
    {
        selectedFiles = e.GetMultipleFiles().ToArray();
    }

    private async Task ProcessImages()
    {
        if (selectedFiles == null || !selectedFiles.Any())
        {
            statusMessage = "No files selected.";
            return;
        }

        processedImages.Clear();

        foreach (var file in selectedFiles)
        {
            if (file.Size > maxFileSize)
            {
                statusMessage = $"File {file.Name} exceeds the maximum allowed size of {maxFileSize / 1024 / 1024}MB.";
                continue;
            }

            using var memoryStream = new MemoryStream();
            await file.OpenReadStream(maxFileSize).CopyToAsync(memoryStream);
            memoryStream.Position = 0; // Reset the stream position to the beginning
            var filePaths = await ImageProcessingService.ProcessImageAsync(memoryStream, file.Name);
            processedImages.AddRange(filePaths);
        }

        statusMessage = "Images processed and saved.";
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NET.Data.ImageProcessingService ImageProcessingService { get; set; }
    }
}
#pragma warning restore 1591
